(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{11:function(e,t,n){e.exports={sign:"Map_sign__3OxH1",signSVG:"Map_signSVG__1pqra",tipContent:"Map_tipContent__31dkD",entryForm:"Map_entryForm__1L4D1",entryDesc:"Map_entryDesc__zskcl"}},31:function(e,t){e.exports="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAMgAAADICAIAAAAiOjnJAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyhpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDE0IDc5LjE1Njc5NywgMjAxNC8wOC8yMC0wOTo1MzowMiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIDIwMTQgKE1hY2ludG9zaCkiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6MTEwMDk1OTdGOERFMTFFNEI1MjdFNkYwQUY5NzlEOEUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6MTEwMDk1OThGOERFMTFFNEI1MjdFNkYwQUY5NzlEOEUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDozRDRCNENBQUY4Q0UxMUU0QjUyN0U2RjBBRjk3OUQ4RSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDoxMTAwOTU5NkY4REUxMUU0QjUyN0U2RjBBRjk3OUQ4RSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/PiKpnkYAAAgtSURBVHja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"},33:function(e,t,n){e.exports=n(46)},45:function(e,t,n){},46:function(e,t,n){"use strict";n.r(t);var a,r=n(0),i=n.n(r),c=n(21),o=n.n(c),l=n(5),s=(n(38),n(13)),u=n(10),A=n(12),d=n(30),E=n(48),p=n(18),m=n(32),b=n(11),D=n.n(b),g=n(31),v=n.n(g),f=n(7),j=n.n(f),O=n(8),C=function(){var e=Object(O.a)(j.a.mark((function e(){var t;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://119.28.68.242:20201","/api/signs"));case 3:return t=e.sent,e.abrupt("return",t.json());case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),F=function(){var e=Object(O.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat("http://119.28.68.242:20201","/api/signs"),{method:"POST",body:JSON.stringify(t),headers:{"content-type":"application/json"}});case 3:return n=e.sent,e.abrupt("return",n.json());case 7:e.prev=7,e.t0=e.catch(0),console.error(e.t0.message);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();!function(e){e[e.INIT_ENTRIES=0]="INIT_ENTRIES",e[e.ADD_ENTRY=1]="ADD_ENTRY",e[e.DELETE_ENTRY=2]="DELETE_ENTRY",e[e.UPDATE_ENTRY=3]="UPDATE_ENTRY",e[e.SET_OPENED_TIP=4]="SET_OPENED_TIP",e[e.UPDATE_ADDED_LOCATION=5]="UPDATE_ADDED_LOCATION"}(a||(a={}));var y=function(e){return{type:a.SET_OPENED_TIP,openedTipState:e}},I=function(e){return{type:a.UPDATE_ADDED_LOCATION,coordinates:e||[]}},T=function(e){var t,n,r,c,o=e.location,l=void 0===o?{type:"Point",coordinates:[0,0]}:o,s=e.children,A=Object(u.b)(),d=Object(m.a)({mode:"onChange"}),E=d.handleSubmit,b=d.register,g=d.errors;return i.a.createElement("form",{className:D.a.entryForm,onSubmit:E((function(e){var t,n=e,r=n.image,i=Object(p.a)({},n,{location:l});r||(i=Object(p.a)({},i,{image:v.a})),A((t=i,function(){var e=Object(O.a)(j.a.mark((function e(n){var r;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F(t);case 2:r=e.sent,n({type:a.ADD_ENTRY,entry:r});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())),A(I(null))}))},i.a.createElement("header",null,i.a.createElement("h3",null,"\u6dfb\u52a0\u6807\u8bb0")),i.a.createElement("main",null,i.a.createElement("input",{placeholder:"\u6807\u9898",name:"title",ref:b({required:"\u6807\u9898\u4e0d\u80fd\u4e3a\u7a7a",pattern:{value:/((?:[\u3400-\u4DBF\u4E00-\u9FFC\uFA0E\uFA0F\uFA11\uFA13\uFA14\uFA1F\uFA21\uFA23\uFA24\uFA27-\uFA29]|[\uD840-\uD868\uD86A-\uD86C\uD86F-\uD872\uD874-\uD879\uD880-\uD883][\uDC00-\uDFFF]|\uD869[\uDC00-\uDEDD\uDF00-\uDFFF]|\uD86D[\uDC00-\uDF34\uDF40-\uDFFF]|\uD86E[\uDC00-\uDC1D\uDC20-\uDFFF]|\uD873[\uDC00-\uDEA1\uDEB0-\uDFFF]|\uD87A[\uDC00-\uDFE0]|\uD884[\uDC00-\uDF4A])|[ 0-9A-Z_a-z])/,message:"\u4ec5\u63a5\u6536\u5b57\u7b26\u6570\u5b57\u7a7a\u683c\u548c\u4e0b\u5212\u7ebf"},validate:function(e){if(e.length>48)return"\u6807\u9898\u6700\u5927\u63a5\u53d748\u5b57\u7b26"}})}),i.a.createElement("div",null,null===(t=g.title)||void 0===t?void 0:t.message),i.a.createElement("input",{placeholder:"\u7ea7\u522b",name:"rating",type:"number",ref:b({pattern:{value:/^[1-5]$/,message:"\u6570\u5b57 1 - 5"}})}),i.a.createElement("div",null,null===(n=g.rating)||void 0===n?void 0:n.message),i.a.createElement("input",{placeholder:"\u56fe\u7247 URL",name:"image",ref:b({pattern:{value:/https?:\/\/(www\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\.[a-zA-Z0-9()]{1,6}\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/,message:"\u65e0\u6548\u7684 URL"}})}),i.a.createElement("div",null,null===(r=g.image)||void 0===r?void 0:r.message),i.a.createElement("textarea",{placeholder:"\u63cf\u8ff0",name:"description",ref:b({validate:function(e){if(e.length>512)return"\u63cf\u8ff0\u6700\u5927\u63a5\u53d7512\u5b57\u7b26"}})}),i.a.createElement("div",null,null===(c=g.description)||void 0===c?void 0:c.message)),i.a.createElement("footer",null,i.a.createElement("span",null,"".concat(l.coordinates[0],", ").concat(l.coordinates[1])),i.a.createElement("br",null),i.a.createElement("button",{type:"submit"},"Confirm")),s)},L=n(1),Y=n(16),W=function(e){var t=e.signEntry,n=e.type,a=void 0===n?"yellow":n,c=e.zoom,o=void 0===c?12:c,A=Object(Y.a)(e,["signEntry","type","zoom"]),d=t.location,E=t._id,p=Object(l.a)(d.coordinates,2),m=p[0],b=p[1],g=Object(u.b)(),v=Object(r.useCallback)((function(e){return function(){g(y(e))}}),[g]);return Object(r.useMemo)((function(){return i.a.createElement(s.a,Object.assign({longitude:m,latitude:b,offsetLeft:-o,offsetTop:2*-o},A),i.a.createElement("div",{className:D.a.sign,onClick:v(Object(L.a)({},E,!0))},i.a.createElement("svg",{className:D.a.signSVG,viewBox:"0 0 24 24",style:{width:"".concat(2*o,"px"),height:"".concat(2*o,"px"),fill:"".concat("yellow"===a?"#e6891e":"#ff2200"),stroke:"white"}},i.a.createElement("path",{d:"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"}),i.a.createElement("circle",{cx:"12",cy:"10",r:"3"}))))}),[E,A,v,b,m,a,o])},N=n(6),S=Object(A.c)({signs:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{entries:[],openedTips:{},addedCoordinates:[]},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case a.INIT_ENTRIES:return{entries:t.entries?Object(N.a)(t.entries):[],openedTips:e.openedTips,addedCoordinates:e.addedCoordinates};case a.SET_OPENED_TIP:return{entries:e.entries,openedTips:Object(p.a)({},e.openedTips,{},t.openedTipState),addedCoordinates:e.addedCoordinates};case a.ADD_ENTRY:return{entries:[].concat(Object(N.a)(e.entries),[t.entry]),openedTips:e.openedTips,addedCoordinates:e.addedCoordinates};case a.UPDATE_ADDED_LOCATION:return{entries:e.entries,openedTips:e.openedTips,addedCoordinates:Object(N.a)(t.coordinates)};default:return e}}}),h=function(e){var t=e.signEntry,n=e.children,a=Object(Y.a)(e,["signEntry","children"]),c=t.location,o=t.title,A=t._id,d=t.description,E=t.image,p=t.rating,m=Object(l.a)(c.coordinates,2),b=m[0],g=m[1],v=Object(u.b)(),f=Object(r.useCallback)((function(e){v(y(e))}),[v]);return Object(r.useMemo)((function(){return i.a.createElement(s.c,Object.assign({className:D.a.tip,longitude:b,latitude:g,closeButton:!0,closeOnClick:!1,anchor:"top",captureScroll:!0,sortByDepth:!0,onClose:function(){f(Object(L.a)({},A,!1))}},a),i.a.createElement("div",{className:D.a.tipContent},n||i.a.createElement("div",{className:D.a.entryDesc},i.a.createElement("header",null,i.a.createElement("h3",null,o)),i.a.createElement("main",null,Object(N.a)(Array(p)).map((function(e){return"\u2b50"})),i.a.createElement("div",{className:D.a.imageContainer},i.a.createElement("img",{src:E,alt:""})),i.a.createElement("article",null,d)),i.a.createElement("footer",null,i.a.createElement("span",null,"".concat(b,", ").concat(g))))))}),[A,a,n,d,f,E,g,b,p,o])},w=function(){var e=Object(r.useState)({latitude:22.828373068332063,longitude:108.30307218045874,zoom:12,maxZoom:15,minZoom:2}),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(u.b)(),A=Object(r.useRef)(null),d=Object(r.useCallback)((function(){o(function(){var e=Object(O.a)(j.a.mark((function e(t){var n;return j.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,C();case 2:n=e.sent,t({type:a.INIT_ENTRIES,entries:n});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}),[o]);Object(r.useEffect)((function(){d()}),[d]);var p=Object(u.c)((function(e){return e.signs.entries})),m=Object(u.c)((function(e){return e.signs.openedTips})),b=Object(u.c)((function(e){return e.signs.addedCoordinates})),D={type:"Point",coordinates:b},g=Object(r.useCallback)((function(e){o(I(e.lngLat))}),[o]),v=Object(r.useCallback)((function(e){o(I(e.lngLat))}),[o]),f=Object(r.useCallback)((function(){o(I(null))}),[o]),F=Object(r.useCallback)((function(e){var t=e.viewState;c(t)}),[]),y=n.zoom;return i.a.createElement(s.d,Object.assign({ref:A,width:"100vw",height:"100vh"},n,{mapStyle:"mapbox://styles/xinleibird/cke3vf72u0kwo19o8kquxfyom",mapboxApiAccessToken:"pk.eyJ1IjoieGlubGVpYmlyZCIsImEiOiJja2RvYWk0ZWIxMGJlMnJxaXMybmI1Z2dyIn0.SbOhikjtRsfPrW9L6xnrzQ",doubleClickZoom:!1,onDblClick:g,onViewStateChange:F}),i.a.createElement("div",{style:{position:"absolute",left:10,top:10}},i.a.createElement(s.b,{showCompass:!0})),p.map((function(e){var t=e._id,n=Object(E.a)(e._id||"","63d601b1-3193-475e-9d1e-ccb1fd077784");return i.a.createElement(r.Fragment,{key:n+"_fragment"},i.a.createElement(W,{signEntry:e,key:n+"_sign",zoom:y}),m[t]&&i.a.createElement(h,{signEntry:e,key:n+"_tip"}))})),2===b.length&&i.a.createElement(i.a.Fragment,null,i.a.createElement(W,{signEntry:{title:"",location:D},type:"red",draggable:!0,onDrag:v,zoom:y}),i.a.createElement(h,{signEntry:{title:"",location:D},onClose:f},i.a.createElement(T,{location:D}))))},x=function(){var e=Object(A.d)(S,Object(A.a)(d.a));return i.a.createElement(u.a,{store:e},i.a.createElement(w,null))};n(45);o.a.render(i.a.createElement(i.a.StrictMode,null,i.a.createElement(x,null)),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.d5372b2c.chunk.js.map